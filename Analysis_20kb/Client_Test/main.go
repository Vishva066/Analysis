package main

import (
	"fmt"
	"os"
	"sync"
	"time"

	"github.com/hyperledger/fabric-gateway/pkg/client"
)

type TxnCounters struct {
	success int
	failure int
	mu      sync.Mutex
}

type GatewayConfig struct {
	gateway  *client.Gateway
	network  *client.Network
	contract *client.Contract
}

func initializeGateway(organization, channelName, chaincodeName, contractName string) (*GatewayConfig, error) {
	orgProfile := profile[organization]
	mspID := orgProfile.MSPID
	certPath := orgProfile.CertPath
	keyPath := orgProfile.KeyDirectory
	tlsCertPath := orgProfile.TLSCertPath
	gatewayPeer := orgProfile.GatewayPeer
	peerEndpoint := orgProfile.PeerEndpoint

	clientConnection := newGrpcConnection(tlsCertPath, gatewayPeer, peerEndpoint)
	id := newIdentity(certPath, mspID)
	sign := newSign(keyPath)

	gw, err := client.Connect(
		id,
		client.WithSign(sign),
		client.WithClientConnection(clientConnection),
		client.WithEvaluateTimeout(5*time.Second),
		client.WithEndorseTimeout(30*time.Second),
		client.WithSubmitTimeout(5*time.Second),
		client.WithCommitStatusTimeout(1*time.Minute),
	)
	if err != nil {
		return nil, fmt.Errorf("failed to connect to gateway: %v", err)
	}

	network := gw.GetNetwork(channelName)
	contract := network.GetContractWithName(chaincodeName, contractName)

	return &GatewayConfig{
		gateway:  gw,
		network:  network,
		contract: contract,
	}, nil
}

func worker(
	jobs <-chan string,
	wg *sync.WaitGroup,
	counters *TxnCounters,
	gwConfig *GatewayConfig,
	txnName string,
) {
	defer wg.Done()

	for carKey := range jobs {
		fmt.Printf("\n-->Submitting Transaction: %s with ID %s\n", txnName, carKey)

		_, err := gwConfig.contract.SubmitTransaction(txnName, carKey, "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", "Nexon", "White", "KBA3", "22/07/2023")

		counters.mu.Lock()
		if err != nil {
			counters.failure++
			fmt.Printf("Transaction failed for %s: %v\n", carKey, err)
		} else {
			counters.success++
		}
		counters.mu.Unlock()
	}
}

func main() {
	var counters TxnCounters
	startTime := time.Now()
	totalTxns := 500000
	numWorkers := 1000
	jobs := make(chan string, totalTxns)

	// Initialize gateway once
	gwConfig, err := initializeGateway(
		"manufacturer",
		"autochannel",
		"KBA-Automobile",
		"CarContract",
	)
	if err != nil {
		panic(fmt.Sprintf("Failed to initialize gateway: %v", err))
	}
	// Ensure gateway is closed after we're done
	defer gwConfig.gateway.Close()

	var wg sync.WaitGroup

	// Start worker goroutines with shared gateway config
	for w := 1; w <= numWorkers; w++ {
		wg.Add(1)
		go worker(jobs, &wg, &counters, gwConfig, "CreateCar")
	}

	// Send transactions as jobs
	for i := 0; i < totalTxns; i++ {
		carKey := fmt.Sprintf("Car2-%d", i)
		jobs <- carKey
	}
	close(jobs)

	wg.Wait()

	endTime := time.Now()
	duration := endTime.Sub(startTime).Seconds()
	// fmt.Printf("\nResults:\n")
	// fmt.Printf("Successes: %d, Failures: %d\n", counters.success, counters.failure)
	// fmt.Printf("Total Transactions: %d, Duration: %.2f seconds, TPS: %.2f\n",
	//     totalTxns, duration, float64(totalTxns)/duration)
	file, err := os.Create("results.txt")
	if err != nil {
		panic(fmt.Sprintf("Failed to create file: %v", err))
	}

	defer file.Close()

	fmt.Fprintf(file, "Performance Results:\n")
	fmt.Fprintf(file, "Successes: %d, Failures: %d\n", counters.success, counters.failure)
	fmt.Fprintf(file, "Total Transactions: %d, Duration: %.2f seconds, TPS: %.2f\n",
		totalTxns, duration, float64(totalTxns)/duration)

	if err != nil {
		panic(fmt.Sprintf("Failed to write to file: %v", err))
	}

	fmt.Println("Results have been written to results.txt")
}
